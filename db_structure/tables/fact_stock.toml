table = "fact_stock"
schema = "public"
database = "query_builder"
table_type = "data"

[fields]
id = {type = "select", show = "false"}
sk_item_id = {type = "select", show = "false"}
sk_warehouse_id = {type = "select", show = "false"}
value = {type = "value", show = "true", name="Запасы. Кол-во шт."}
date = {type = "select", show = "false"}

#[calculations]
last_day_of_week_pcs = {type = "calculation", show = "true", calculation = "sum(query_builder.public.fact_stock.value)", where = "query_builder.public.dim_calendar.last_day_of_week = 1", fact_must_join_on = ["query_builder.public.dim_calendar.week_no", "query_builder.public.dim_calendar.year"], no_join_fact = "query_builder.public.dim_calendar.date", name="Запасы на последний день недели, шт"}
first_day_of_week_pcs = {type = "calculation", show = "true", calculation = "sum(query_builder.public.fact_stock.value)", where = "query_builder.public.dim_calendar.first_day_of_week = 1", fact_must_join_on = ["query_builder.public.dim_calendar.week_no", "query_builder.public.dim_calendar.year"], no_join_fact = "query_builder.public.dim_calendar.date", name="Запасы на первый день недели, шт"}
last_day_of_week_rub = {type = "calculation", show = "true", calculation = "sum(query_builder.public.fact_stock.value * query_builder.public.item.price)", where = "query_builder.public.dim_calendar.last_day_of_week = 1", fact_must_join_on = ["query_builder.public.dim_calendar.week_no", "query_builder.public.dim_calendar.year"], no_join_fact = "query_builder.public.dim_calendar.date", name="Запасы на последний день недели, руб"}
first_day_of_week_rub = {type = "calculation", show = "true", calculation = "sum(query_builder.public.fact_stock.value * query_builder.public.item.price)", where = "query_builder.public.dim_calendar.first_day_of_week = 1", fact_must_join_on = ["query_builder.public.dim_calendar.week_no", "query_builder.public.dim_calendar.year"], no_join_fact = "query_builder.public.dim_calendar.date", name="Запасы на последний день недели, руб"}
